/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sporwal1818 (shri_krishna) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in ./wandb/run-20250327_184834-b3lq4tps
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ImagenetModels--data=imagenet_3channel--submodel=submodel=resnet18
wandb: â­ï¸ View project at https://wandb.ai/shri_krishna/DeepLenseClassificationTask
wandb: ğŸš€ View run at https://wandb.ai/shri_krishna/DeepLenseClassificationTask/runs/b3lq4tps
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ    â”ƒ Name                    â”ƒ Type                      â”ƒ Params â”ƒ
â”¡â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0  â”‚ model_obj               â”‚ ImagenetModels            â”‚ 11.2 M â”‚
â”‚ 1  â”‚ model_obj.model         â”‚ ResNet                    â”‚ 11.2 M â”‚
â”‚ 2  â”‚ model_obj.model.conv1   â”‚ Conv2d                    â”‚  9.4 K â”‚
â”‚ 3  â”‚ model_obj.model.bn1     â”‚ BatchNorm2d               â”‚    128 â”‚
â”‚ 4  â”‚ model_obj.model.relu    â”‚ ReLU                      â”‚      0 â”‚
â”‚ 5  â”‚ model_obj.model.maxpool â”‚ MaxPool2d                 â”‚      0 â”‚
â”‚ 6  â”‚ model_obj.model.layer1  â”‚ Sequential                â”‚  147 K â”‚
â”‚ 7  â”‚ model_obj.model.layer2  â”‚ Sequential                â”‚  525 K â”‚
â”‚ 8  â”‚ model_obj.model.layer3  â”‚ Sequential                â”‚  2.1 M â”‚
â”‚ 9  â”‚ model_obj.model.layer4  â”‚ Sequential                â”‚  8.4 M â”‚
â”‚ 10 â”‚ model_obj.model.avgpool â”‚ AdaptiveAvgPool2d         â”‚      0 â”‚
â”‚ 11 â”‚ model_obj.model.fc      â”‚ Linear                    â”‚  1.5 K â”‚
â”‚ 12 â”‚ tr_kappa                â”‚ MulticlassCohenKappa      â”‚      0 â”‚
â”‚ 13 â”‚ val_kappa               â”‚ MulticlassCohenKappa      â”‚      0 â”‚
â”‚ 14 â”‚ tst_kappa               â”‚ MulticlassCohenKappa      â”‚      0 â”‚
â”‚ 15 â”‚ tr_accuracy             â”‚ MulticlassAccuracy        â”‚      0 â”‚
â”‚ 16 â”‚ val_accuracy            â”‚ MulticlassAccuracy        â”‚      0 â”‚
â”‚ 17 â”‚ tst_accuracy            â”‚ MulticlassAccuracy        â”‚      0 â”‚
â”‚ 18 â”‚ val_conf_mat            â”‚ MulticlassConfusionMatrix â”‚      0 â”‚
â”‚ 19 â”‚ criterion               â”‚ CrossEntropyLoss          â”‚      0 â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 11.2 M                                                        
Non-trainable params: 0                                                         
Total params: 11.2 M                                                            
Total estimated model params size (MB): 44                                      
SLURM auto-requeueing enabled. Setting signal handlers.
Metric val_ce_loss improved. New best score: 1.104
Epoch 0, global step 95: 'val_ce_loss' reached 1.10362 (best 1.10362), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=0 | val_ce_loss=1.104 | val_kappa=0.023 | val_acc=0.345.ckpt' as top 1
Epoch 1, global step 190: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.004 >= min_delta = 5e-05. New best score: 1.100
Epoch 2, global step 285: 'val_ce_loss' reached 1.09952 (best 1.09952), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=2 | val_ce_loss=1.100 | val_kappa=0.034 | val_acc=0.349.ckpt' as top 1
Epoch 3, global step 380: 'val_ce_loss' was not in top 1
Epoch 4, global step 475: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.003 >= min_delta = 5e-05. New best score: 1.097
Epoch 5, global step 570: 'val_ce_loss' reached 1.09698 (best 1.09698), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=5 | val_ce_loss=1.097 | val_kappa=0.056 | val_acc=0.359.ckpt' as top 1
Metric val_ce_loss improved by 0.005 >= min_delta = 5e-05. New best score: 1.092
Epoch 6, global step 665: 'val_ce_loss' reached 1.09211 (best 1.09211), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=6 | val_ce_loss=1.092 | val_kappa=0.086 | val_acc=0.366.ckpt' as top 1
Metric val_ce_loss improved by 0.009 >= min_delta = 5e-05. New best score: 1.083
Epoch 7, global step 760: 'val_ce_loss' reached 1.08348 (best 1.08348), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=7 | val_ce_loss=1.083 | val_kappa=0.116 | val_acc=0.380.ckpt' as top 1
Epoch 8, global step 855: 'val_ce_loss' was not in top 1
Epoch 9, global step 950: 'val_ce_loss' was not in top 1
Epoch 10, global step 1045: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.067 >= min_delta = 5e-05. New best score: 1.016
Epoch 11, global step 1140: 'val_ce_loss' reached 1.01636 (best 1.01636), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=11 | val_ce_loss=1.016 | val_kappa=0.287 | val_acc=0.463.ckpt' as top 1
Epoch 12, global step 1235: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.017 >= min_delta = 5e-05. New best score: 0.999
Epoch 13, global step 1330: 'val_ce_loss' reached 0.99907 (best 0.99907), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=13 | val_ce_loss=0.999 | val_kappa=0.350 | val_acc=0.482.ckpt' as top 1
Epoch 14, global step 1425: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.079 >= min_delta = 5e-05. New best score: 0.920
Epoch 15, global step 1520: 'val_ce_loss' reached 0.91991 (best 0.91991), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=15 | val_ce_loss=0.920 | val_kappa=0.493 | val_acc=0.543.ckpt' as top 1
Epoch 16, global step 1615: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.003 >= min_delta = 5e-05. New best score: 0.917
Epoch 17, global step 1710: 'val_ce_loss' reached 0.91728 (best 0.91728), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=17 | val_ce_loss=0.917 | val_kappa=0.462 | val_acc=0.551.ckpt' as top 1
Epoch 18, global step 1805: 'val_ce_loss' was not in top 1
Epoch 19, global step 1900: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.034 >= min_delta = 5e-05. New best score: 0.883
Epoch 20, global step 1995: 'val_ce_loss' reached 0.88338 (best 0.88338), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=20 | val_ce_loss=0.883 | val_kappa=0.513 | val_acc=0.567.ckpt' as top 1
Epoch 21, global step 2090: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.016 >= min_delta = 5e-05. New best score: 0.867
Epoch 22, global step 2185: 'val_ce_loss' reached 0.86736 (best 0.86736), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=22 | val_ce_loss=0.867 | val_kappa=0.522 | val_acc=0.573.ckpt' as top 1
Epoch 23, global step 2280: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.048 >= min_delta = 5e-05. New best score: 0.820
Epoch 24, global step 2375: 'val_ce_loss' reached 0.81953 (best 0.81953), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=24 | val_ce_loss=0.820 | val_kappa=0.583 | val_acc=0.606.ckpt' as top 1
Epoch 25, global step 2470: 'val_ce_loss' was not in top 1
Epoch 26, global step 2565: 'val_ce_loss' was not in top 1
Epoch 27, global step 2660: 'val_ce_loss' was not in top 1
Epoch 28, global step 2755: 'val_ce_loss' was not in top 1
Epoch 29, global step 2850: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.068 >= min_delta = 5e-05. New best score: 0.752
Epoch 30, global step 2945: 'val_ce_loss' reached 0.75159 (best 0.75159), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=30 | val_ce_loss=0.752 | val_kappa=0.633 | val_acc=0.634.ckpt' as top 1
Epoch 31, global step 3040: 'val_ce_loss' was not in top 1
Epoch 32, global step 3135: 'val_ce_loss' was not in top 1
Epoch 33, global step 3230: 'val_ce_loss' was not in top 1
Epoch 34, global step 3325: 'val_ce_loss' was not in top 1
Epoch 35, global step 3420: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.011 >= min_delta = 5e-05. New best score: 0.741
Epoch 36, global step 3515: 'val_ce_loss' reached 0.74080 (best 0.74080), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=36 | val_ce_loss=0.741 | val_kappa=0.638 | val_acc=0.646.ckpt' as top 1
Epoch 37, global step 3610: 'val_ce_loss' was not in top 1
Epoch 38, global step 3705: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.028 >= min_delta = 5e-05. New best score: 0.713
Epoch 39, global step 3800: 'val_ce_loss' reached 0.71261 (best 0.71261), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=39 | val_ce_loss=0.713 | val_kappa=0.653 | val_acc=0.661.ckpt' as top 1
Epoch 40, global step 3895: 'val_ce_loss' was not in top 1
Epoch 41, global step 3990: 'val_ce_loss' was not in top 1
Epoch 42, global step 4085: 'val_ce_loss' was not in top 1
Epoch 43, global step 4180: 'val_ce_loss' was not in top 1
Epoch 44, global step 4275: 'val_ce_loss' was not in top 1
Epoch 45, global step 4370: 'val_ce_loss' was not in top 1
Epoch 46, global step 4465: 'val_ce_loss' was not in top 1
Monitored metric val_ce_loss did not improve in the last 8 records. Best score: 0.713. Signaling Trainer to stop.
Epoch 47, global step 4560: 'val_ce_loss' was not in top 1
Epoch 47/99 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 380/380 0:00:30 â€¢       12.65it/s v_num: ps_1      
                                     0:00:00                   val_ce_loss:     
                                                               1.045 val_kappa: 
                                                               0.465 val_acc:   
                                                               0.532            
                                                               train_ce_loss:   
                                                               0.604            
                                                               train_kappa:     
                                                               0.724 train_acc: 
                                                               0.728            
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ        Test metric        â”ƒ       DataLoader 0        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚      test_acc_epoch       â”‚    0.5406666398048401     â”‚
â”‚    test_ce_loss_epoch     â”‚     1.022071361541748     â”‚
â”‚     test_kappa_epoch      â”‚    0.4765123128890991     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Testing â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 47/47 0:00:06 â€¢ 0:00:00 7.19it/s 
[1;34mwandb[0m: 
[1;34mwandb[0m: ğŸš€ View run [33mImagenetModels--data=imagenet_3channel--submodel=submodel=resnet18[0m at: [34mhttps://wandb.ai/shri_krishna/DeepLenseClassificationTask/runs/b3lq4tps[0m
