/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sporwal1818 (shri_krishna) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in ./wandb/run-20250329_162035-l6qt08qc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ImagenetModels--data=imagenet_3channel--submodel=submodel=resnet18
wandb: ⭐️ View project at https://wandb.ai/shri_krishna/DeepLenseClassificationTask
wandb: 🚀 View run at https://wandb.ai/shri_krishna/DeepLenseClassificationTask/runs/l6qt08qc
/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:652: Checkpoint directory results/Classification/ImagenetModels--data=imagenet_3channel/ckpts exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃    ┃ Name                    ┃ Type                      ┃ Params ┃
┡━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0  │ model_obj               │ ImagenetModels            │ 11.2 M │
│ 1  │ model_obj.model         │ ResNet                    │ 11.2 M │
│ 2  │ model_obj.model.conv1   │ Conv2d                    │  9.4 K │
│ 3  │ model_obj.model.bn1     │ BatchNorm2d               │    128 │
│ 4  │ model_obj.model.relu    │ ReLU                      │      0 │
│ 5  │ model_obj.model.maxpool │ MaxPool2d                 │      0 │
│ 6  │ model_obj.model.layer1  │ Sequential                │  147 K │
│ 7  │ model_obj.model.layer2  │ Sequential                │  525 K │
│ 8  │ model_obj.model.layer3  │ Sequential                │  2.1 M │
│ 9  │ model_obj.model.layer4  │ Sequential                │  8.4 M │
│ 10 │ model_obj.model.avgpool │ AdaptiveAvgPool2d         │      0 │
│ 11 │ model_obj.model.fc      │ Linear                    │  1.5 K │
│ 12 │ tr_kappa                │ MulticlassCohenKappa      │      0 │
│ 13 │ val_kappa               │ MulticlassCohenKappa      │      0 │
│ 14 │ tst_kappa               │ MulticlassCohenKappa      │      0 │
│ 15 │ tr_accuracy             │ MulticlassAccuracy        │      0 │
│ 16 │ val_accuracy            │ MulticlassAccuracy        │      0 │
│ 17 │ tst_accuracy            │ MulticlassAccuracy        │      0 │
│ 18 │ val_conf_mat            │ MulticlassConfusionMatrix │      0 │
│ 19 │ criterion               │ CrossEntropyLoss          │      0 │
└────┴─────────────────────────┴───────────────────────────┴────────┘
Trainable params: 11.2 M                                                        
Non-trainable params: 0                                                         
Total params: 11.2 M                                                            
Total estimated model params size (MB): 44                                      
SLURM auto-requeueing enabled. Setting signal handlers.
Metric val_ce_loss improved. New best score: 1.086
Epoch 0, global step 95: 'val_ce_loss' reached 1.08600 (best 1.08600), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=0 | val_ce_loss=1.086 | val_kappa=0.117 | val_acc=0.389.ckpt' as top 1
Metric val_ce_loss improved by 0.020 >= min_delta = 5e-05. New best score: 1.066
Epoch 1, global step 190: 'val_ce_loss' reached 1.06598 (best 1.06598), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=1 | val_ce_loss=1.066 | val_kappa=0.185 | val_acc=0.421.ckpt' as top 1
Metric val_ce_loss improved by 0.013 >= min_delta = 5e-05. New best score: 1.053
Epoch 2, global step 285: 'val_ce_loss' reached 1.05279 (best 1.05279), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=2 | val_ce_loss=1.053 | val_kappa=0.188 | val_acc=0.437.ckpt' as top 1
Metric val_ce_loss improved by 0.006 >= min_delta = 5e-05. New best score: 1.047
Epoch 3, global step 380: 'val_ce_loss' reached 1.04658 (best 1.04658), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=3 | val_ce_loss=1.047 | val_kappa=0.254 | val_acc=0.463.ckpt' as top 1
Metric val_ce_loss improved by 0.015 >= min_delta = 5e-05. New best score: 1.032
Epoch 4, global step 475: 'val_ce_loss' reached 1.03170 (best 1.03170), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=4 | val_ce_loss=1.032 | val_kappa=0.282 | val_acc=0.483.ckpt' as top 1
Metric val_ce_loss improved by 0.028 >= min_delta = 5e-05. New best score: 1.004
Epoch 5, global step 570: 'val_ce_loss' reached 1.00392 (best 1.00392), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=5 | val_ce_loss=1.004 | val_kappa=0.341 | val_acc=0.502.ckpt' as top 1
Metric val_ce_loss improved by 0.006 >= min_delta = 5e-05. New best score: 0.997
Epoch 6, global step 665: 'val_ce_loss' reached 0.99744 (best 0.99744), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=6 | val_ce_loss=0.997 | val_kappa=0.358 | val_acc=0.514.ckpt' as top 1
Metric val_ce_loss improved by 0.019 >= min_delta = 5e-05. New best score: 0.978
Epoch 7, global step 760: 'val_ce_loss' reached 0.97815 (best 0.97815), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=7 | val_ce_loss=0.978 | val_kappa=0.363 | val_acc=0.525.ckpt' as top 1
Metric val_ce_loss improved by 0.021 >= min_delta = 5e-05. New best score: 0.957
Epoch 8, global step 855: 'val_ce_loss' reached 0.95742 (best 0.95742), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=8 | val_ce_loss=0.957 | val_kappa=0.418 | val_acc=0.544.ckpt' as top 1
Metric val_ce_loss improved by 0.016 >= min_delta = 5e-05. New best score: 0.942
Epoch 9, global step 950: 'val_ce_loss' reached 0.94160 (best 0.94160), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=9 | val_ce_loss=0.942 | val_kappa=0.448 | val_acc=0.559.ckpt' as top 1
Epoch 10, global step 1045: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.014 >= min_delta = 5e-05. New best score: 0.927
Epoch 11, global step 1140: 'val_ce_loss' reached 0.92712 (best 0.92712), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=11 | val_ce_loss=0.927 | val_kappa=0.456 | val_acc=0.581.ckpt' as top 1
Metric val_ce_loss improved by 0.004 >= min_delta = 5e-05. New best score: 0.923
Epoch 12, global step 1235: 'val_ce_loss' reached 0.92271 (best 0.92271), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=12 | val_ce_loss=0.923 | val_kappa=0.478 | val_acc=0.581.ckpt' as top 1
Epoch 13, global step 1330: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.009 >= min_delta = 5e-05. New best score: 0.914
Epoch 14, global step 1425: 'val_ce_loss' reached 0.91401 (best 0.91401), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=14 | val_ce_loss=0.914 | val_kappa=0.492 | val_acc=0.599.ckpt' as top 1
Metric val_ce_loss improved by 0.023 >= min_delta = 5e-05. New best score: 0.891
Epoch 15, global step 1520: 'val_ce_loss' reached 0.89111 (best 0.89111), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=15 | val_ce_loss=0.891 | val_kappa=0.516 | val_acc=0.615.ckpt' as top 1
Epoch 16, global step 1615: 'val_ce_loss' was not in top 1
Metric val_ce_loss improved by 0.012 >= min_delta = 5e-05. New best score: 0.879
Epoch 17, global step 1710: 'val_ce_loss' reached 0.87915 (best 0.87915), saving model to 'results/Classification/ImagenetModels--data=imagenet_3channel/ckpts/submodel=resnet18--epoch=17 | val_ce_loss=0.879 | val_kappa=0.529 | val_acc=0.620.ckpt' as top 1
Epoch 18, global step 1805: 'val_ce_loss' was not in top 1
Epoch 19, global step 1900: 'val_ce_loss' was not in top 1
Epoch 20, global step 1995: 'val_ce_loss' was not in top 1
Epoch 21, global step 2090: 'val_ce_loss' was not in top 1
Epoch 22, global step 2185: 'val_ce_loss' was not in top 1
Epoch 23, global step 2280: 'val_ce_loss' was not in top 1
Epoch 24, global step 2375: 'val_ce_loss' was not in top 1
Epoch 25, global step 2470: 'val_ce_loss' was not in top 1
Epoch 26, global step 2565: 'val_ce_loss' was not in top 1
Monitored metric val_ce_loss did not improve in the last 10 records. Best score: 0.879. Signaling Trainer to stop.
Epoch 27, global step 2660: 'val_ce_loss' was not in top 1
Epoch 27/149 ━━━━━━━━━━━━━━━ 380/380 0:00:27 •       13.94it/s v_num: qc_3      
                                     0:00:00                   val_ce_loss:     
                                                               0.912 val_kappa: 
                                                               0.534 val_acc:   
                                                               0.622            
                                                               train_ce_loss:   
                                                               0.679            
                                                               train_kappa:     
                                                               0.723 train_acc: 
                                                               0.771            
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│      test_acc_epoch       │    0.6320000290870667     │
│    test_ce_loss_epoch     │    0.8944753408432007     │
│     test_kappa_epoch      │    0.5607196092605591     │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 47/47 0:00:06 • 0:00:00 6.66it/s 
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mImagenetModels--data=imagenet_3channel--submodel=submodel=resnet18[0m at: [34mhttps://wandb.ai/shri_krishna/DeepLenseClassificationTask/runs/l6qt08qc[0m
