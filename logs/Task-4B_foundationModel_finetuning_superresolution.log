/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:62: FutureWarning: Importing `PeakSignalNoiseRatio` from `torchmetrics` was deprecated and will be removed in 2.0. Import `PeakSignalNoiseRatio` from `torchmetrics.image` instead.
  _future_warning(
/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:62: FutureWarning: Importing `PeakSignalNoiseRatio` from `torchmetrics` was deprecated and will be removed in 2.0. Import `PeakSignalNoiseRatio` from `torchmetrics.image` instead.
  _future_warning(
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sporwal1818 (shri_krishna) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in ./wandb/run-20250327_213403-ttqdbx77
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Task-4B_SuperRes_finetuned_super_res
wandb: â­ï¸ View project at https://wandb.ai/shri_krishna/DeepLense_FoundationModels_Analysis
wandb: ğŸš€ View run at https://wandb.ai/shri_krishna/DeepLense_FoundationModels_Analysis/runs/ttqdbx77
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
76 4 76 4
Successfully loaded the encoder weights for Super Resolution
â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ    â”ƒ Name                             â”ƒ Type                        â”ƒ Params â”ƒ
â”¡â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0  â”‚ model                            â”‚ SuperResolutionAE           â”‚  8.8 M â”‚
â”‚ 1  â”‚ model.encoder                    â”‚ ViT                         â”‚  8.0 M â”‚
â”‚ 2  â”‚ model.encoder.to_patch_embedding â”‚ Sequential                  â”‚  4.9 K â”‚
â”‚ 3  â”‚ model.encoder.transformer        â”‚ Transformer                 â”‚  7.9 M â”‚
â”‚ 4  â”‚ model.encoder.to_latent          â”‚ Identity                    â”‚      0 â”‚
â”‚ 5  â”‚ model.encoder.mlp_head           â”‚ Linear                      â”‚    771 â”‚
â”‚ 6  â”‚ model.encoder.dropout            â”‚ Dropout                     â”‚      0 â”‚
â”‚ 7  â”‚ model.patch_to_emb               â”‚ Sequential                  â”‚  4.9 K â”‚
â”‚ 8  â”‚ model.enc_to_dec                 â”‚ Linear                      â”‚ 32.9 K â”‚
â”‚ 9  â”‚ model.decoder                    â”‚ Transformer                 â”‚  692 K â”‚
â”‚ 10 â”‚ model.decoder.norm               â”‚ LayerNorm                   â”‚    256 â”‚
â”‚ 11 â”‚ model.decoder.layers             â”‚ ModuleList                  â”‚  692 K â”‚
â”‚ 12 â”‚ model.decoder_pos_emb            â”‚ Embedding                   â”‚ 46.3 K â”‚
â”‚ 13 â”‚ model.to_pixels                  â”‚ Linear                      â”‚  2.1 K â”‚
â”‚ 14 â”‚ model.upsample                   â”‚ Sequential                  â”‚  1.2 K â”‚
â”‚ 15 â”‚ model.upsample.0                 â”‚ Rearrange                   â”‚      0 â”‚
â”‚ 16 â”‚ model.upsample.1                 â”‚ Upsample                    â”‚      0 â”‚
â”‚ 17 â”‚ model.upsample.2                 â”‚ Conv2d                      â”‚    640 â”‚
â”‚ 18 â”‚ model.upsample.3                 â”‚ PReLU                       â”‚      1 â”‚
â”‚ 19 â”‚ model.upsample.4                 â”‚ Conv2d                      â”‚    577 â”‚
â”‚ 20 â”‚ model.upsample.5                 â”‚ Sigmoid                     â”‚      0 â”‚
â”‚ 21 â”‚ tr_ssim                          â”‚ StructuralSimilarityIndexMâ€¦ â”‚      0 â”‚
â”‚ 22 â”‚ val_ssim                         â”‚ StructuralSimilarityIndexMâ€¦ â”‚      0 â”‚
â”‚ 23 â”‚ tst_ssim                         â”‚ StructuralSimilarityIndexMâ€¦ â”‚      0 â”‚
â”‚ 24 â”‚ mse                              â”‚ MSELoss                     â”‚      0 â”‚
â”‚ 25 â”‚ tr_psnr                          â”‚ _PeakSignalNoiseRatio       â”‚      0 â”‚
â”‚ 26 â”‚ val_psnr                         â”‚ _PeakSignalNoiseRatio       â”‚      0 â”‚
â”‚ 27 â”‚ tst_psnr                         â”‚ _PeakSignalNoiseRatio       â”‚      0 â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 8.8 M                                                         
Non-trainable params: 0                                                         
Total params: 8.8 M                                                             
Total estimated model params size (MB): 35                                      
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
76 4 76 4
Successfully loaded the encoder weights for Super Resolution
[rank: 0] Metric val_MSE_loss improved. New best score: 0.091
[rank: 1] Metric val_MSE_loss improved. New best score: 0.091
Epoch 0, global step 22: 'val_MSE_loss' reached 0.09083 (best 0.09083), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=0 | val_MSE_loss=0.091.ckpt' as top 1
[rank: 0] Metric val_MSE_loss improved by 0.067 >= min_delta = 5e-05. New best score: 0.024
[rank: 1] Metric val_MSE_loss improved by 0.067 >= min_delta = 5e-05. New best score: 0.024
Epoch 1, global step 44: 'val_MSE_loss' reached 0.02392 (best 0.02392), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=1 | val_MSE_loss=0.024.ckpt' as top 1
[rank: 0] Metric val_MSE_loss improved by 0.008 >= min_delta = 5e-05. New best score: 0.015
[rank: 1] Metric val_MSE_loss improved by 0.008 >= min_delta = 5e-05. New best score: 0.015
Epoch 2, global step 66: 'val_MSE_loss' reached 0.01547 (best 0.01547), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=2 | val_MSE_loss=0.015.ckpt' as top 1
[rank: 1] Metric val_MSE_loss improved by 0.001 >= min_delta = 5e-05. New best score: 0.014
[rank: 0] Metric val_MSE_loss improved by 0.001 >= min_delta = 5e-05. New best score: 0.014
Epoch 3, global step 88: 'val_MSE_loss' reached 0.01450 (best 0.01450), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=3 | val_MSE_loss=0.014.ckpt' as top 1
[rank: 0] Metric val_MSE_loss improved by 0.000 >= min_delta = 5e-05. New best score: 0.014
[rank: 1] Metric val_MSE_loss improved by 0.000 >= min_delta = 5e-05. New best score: 0.014
Epoch 4, global step 110: 'val_MSE_loss' reached 0.01430 (best 0.01430), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=4 | val_MSE_loss=0.014.ckpt' as top 1
[rank: 0] Metric val_MSE_loss improved by 0.000 >= min_delta = 5e-05. New best score: 0.014
[rank: 1] Metric val_MSE_loss improved by 0.000 >= min_delta = 5e-05. New best score: 0.014
Epoch 5, global step 132: 'val_MSE_loss' reached 0.01423 (best 0.01423), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=5 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 6, global step 154: 'val_MSE_loss' reached 0.01420 (best 0.01420), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=6 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 7, global step 176: 'val_MSE_loss' reached 0.01419 (best 0.01419), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=7 | val_MSE_loss=0.014.ckpt' as top 1
[rank: 0] Metric val_MSE_loss improved by 0.000 >= min_delta = 5e-05. New best score: 0.014
[rank: 1] Metric val_MSE_loss improved by 0.000 >= min_delta = 5e-05. New best score: 0.014
Epoch 8, global step 198: 'val_MSE_loss' reached 0.01418 (best 0.01418), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=8 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 9, global step 220: 'val_MSE_loss' reached 0.01417 (best 0.01417), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=9 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 10, global step 242: 'val_MSE_loss' reached 0.01417 (best 0.01417), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=10 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 11, global step 264: 'val_MSE_loss' reached 0.01416 (best 0.01416), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=11 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 12, global step 286: 'val_MSE_loss' reached 0.01416 (best 0.01416), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=12 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 13, global step 308: 'val_MSE_loss' reached 0.01416 (best 0.01416), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=13 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 14, global step 330: 'val_MSE_loss' reached 0.01415 (best 0.01415), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=14 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 15, global step 352: 'val_MSE_loss' reached 0.01415 (best 0.01415), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=15 | val_MSE_loss=0.014.ckpt' as top 1
[rank: 0] Monitored metric val_MSE_loss did not improve in the last 8 records. Best score: 0.014. Signaling Trainer to stop.
[rank: 1] Monitored metric val_MSE_loss did not improve in the last 8 records. Best score: 0.014. Signaling Trainer to stop.
Epoch 16, global step 374: 'val_MSE_loss' reached 0.01415 (best 0.01415), saving model to 'results/MAE/Task-4B_SuperRes_finetuned_super_res/ckpts/epoch=16 | val_MSE_loss=0.014.ckpt' as top 1
Epoch 16/199 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 64/64 0:00:11 â€¢ 0:00:00 5.89it/s v_num: 77_3      
                                                               val_MSE_loss:    
                                                               0.014 val_PSNR:  
                                                               18.496 val_SSIM: 
                                                               0.440            
                                                               train_MSE_loss:  
                                                               0.014 train_PSNR:
                                                               18.507           
                                                               train_SSIM: 0.432
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
/home/s_porwal_me.iitr/miniconda3/envs/deeplense/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:232: Using `DistributedSampler` with the dataloaders. During `trainer.test()`, it is recommended to use `Trainer(devices=1, num_nodes=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices have same batch size in case of uneven inputs.
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ        Test metric        â”ƒ       DataLoader 0        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚       test_MSE_loss       â”‚   0.014111820608377457    â”‚
â”‚         test_PSNR         â”‚    18.506502151489258     â”‚
â”‚         test_SSIM         â”‚    0.43988436460494995    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Testing â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 8/8 0:00:00 â€¢ 0:00:00 43.83it/s 
[1;34mwandb[0m: 
[1;34mwandb[0m: ğŸš€ View run [33mTask-4B_SuperRes_finetuned_super_res[0m at: [34mhttps://wandb.ai/shri_krishna/DeepLense_FoundationModels_Analysis/runs/ttqdbx77[0m
